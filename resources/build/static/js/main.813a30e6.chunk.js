(this["webpackJsonpcoljure-do-you-know-me-frontend"]=this["webpackJsonpcoljure-do-you-know-me-frontend"]||[]).push([[0],[,,,,,,,,,,function(e,t,n){e.exports={root:"start_root__nvgyY","input-label":"start_input-label__1wIFV"}},,,,,,,,,,,,function(e,t,n){e.exports=n(50)},,,,,function(e,t,n){},function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(18),c=(n(27),n(1)),o=n(8),s=n(6),u=r.a.createContext(),i=r.a.createContext(),m=(n(28),r.a.createContext()),E=function(e){var t=Object(a.useState)(new WebSocket("ws://localhost:9090")),n=Object(c.a)(t,2),l=n[0],o=n[1];return Object(a.useEffect)((function(){l.onopen=function(){console.log("CONNECTED"),sessionStorage.gameId&&l.send(JSON.stringify({action:"GET_GAME_STATE",id:sessionStorage.gameId})),sessionStorage.playerId&&l.send(JSON.stringify({action:"GET_GAME_STATE",id:sessionStorage.playerId}))}})),r.a.createElement(m.Provider,{value:{socket:l,setSocket:o}},e.children)},p=n(10),f=n.n(p),d=function(e){console.log(e);var t=Object(a.useContext)(m).socket,n=Object(a.useContext)(u).gameState,l=Object(a.useState)(""),o=Object(c.a)(l,2),i=o[0],E=o[1],p=Object(a.useState)(""),d=Object(c.a)(p,2),y=d[0],g=d[1],b=Object(s.e)(),O=Object(a.useCallback)((function(e){return b.push(e)}),[b]);Object(a.useEffect)((function(){return n&&sessionStorage.getItem("playerId")?O("game/".concat(n.id,"/").concat(sessionStorage.getItem("playerId"))):n?O("game/".concat(n.id)):void 0}),[n,O]);var S=function(e){return function(t){return e(t.target.value)}};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:f.a.root},r.a.createElement("h1",null,"Welcome"),r.a.createElement("button",{onClick:function(){return t.send(JSON.stringify({action:"CREATE_GAME",id:null}))},disabled:!t},"Create Game"),r.a.createElement("h2",null,"Or Join a game"),r.a.createElement("form",{id:"joinRoomForm",onSubmit:function(e){e.preventDefault(),t.send(JSON.stringify({action:"JOIN_GAME",id:i}))}},r.a.createElement("label",{className:f.a["input-label"],htmlFor:"room-code"},"Enter room code",r.a.createElement("input",{type:"text",name:"room-code",onChange:S(E),value:i,autoFocus:!0})),r.a.createElement("label",{className:f.a["input-label"],htmlFor:"username"},"Username",r.a.createElement("input",{type:"text",name:"username",onChange:S(g),value:y,autoFocus:!0}))),r.a.createElement("br",null),r.a.createElement("button",{type:"submit",form:"joinRoomForm"},"Join game")))},y=(n(33),function(){var e=Object(a.useContext)(m).socket,t=Object(a.useContext)(u).setGameState,n=Object(s.e)();return r.a.createElement("div",{className:"leave-game"},r.a.createElement("button",{onClick:function(){t(null),sessionStorage.clear(),e.close(),n.push("/")}},"Leave game"))}),g=(n(34),function(e){return r.a.createElement("p",{style:{color:"".concat(e.textColor)}},r.a.createElement("span",null,e.player.emoji),e.player.username,e.score&&r.a.createElement("span",{style:{color:"#000",fontSize:"2rem",marginLeft:"20px"}},"score: ",e.score))}),b=n(21),O=(n(35),function(e){var t=Object(a.useContext)(u).gameState;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(r.a.Fragment,null," ",t.turn===sessionStorage.playerId?r.a.createElement("div",{className:"question",style:{backgroundColor:"".concat(e.question.focus&&e.player.color)}},e.question.points):r.a.createElement("div",{className:"\n        question \n        ".concat(t.turn===e.question.playerId&&t.gameStarted?"disabled":""," \n        ").concat(e.question.focus&&e.player.id!==t.turn?"focused":""),style:Object(b.a)({backgroundColor:"".concat(e.question.focus?t.players[t.turn].color:"#ffffff")},e.style,{opacity:"".concat(e.question.answered?"0":"1")})},e.question.points,r.a.createElement("span",null,e.question.focus?t.players[t.turn].emoji:""))))}),S=(n(36),n(37),function(e){var t=Object(a.useState)(""),n=Object(c.a)(t,2),l=n[0],o=n[1];return Object(a.useEffect)((function(){e.started&&o("start-animation")}),[e.started,o]),r.a.createElement("div",{className:"game-started"},r.a.createElement("h1",{className:l},"GAME STARTED"))}),j=(n(38),function(){var e=Object(a.useContext)(u).gameState;return r.a.createElement("div",{className:"wrapper"},console.log(e.activeQuestion),e&&e.activeQuestion&&r.a.createElement("div",{className:"question-pop-up",style:{backgroundColor:"".concat(e.players[e.activeQuestion.playerId].color)}},r.a.createElement("span",null,e.players[e.activeQuestion.playerId].emoji),r.a.createElement("h1",null,function(t){return t.question.includes("your")?t.question.replace("your","".concat(e.players[t.playerId].username.charAt(0).toUpperCase()+e.players[t.playerId].username.slice(1),"'s")):t.question.includes("you")?t.question.replace("you","".concat(e.players[t.playerId].username.charAt(0).toUpperCase()+e.players[t.playerId].username.slice(1))):void 0}(e.activeQuestion)),r.a.createElement("section",null,Object.keys(e.players).filter((function(t){return t!==e.activeQuestion.playerId})).map((function(t,n){return r.a.createElement(r.a.Fragment,null,!Object.keys(e.activeQuestion.answers).includes(e.players[t].id)&&r.a.createElement("span",{role:"img","aria-label":"hourglass"},"\u23f3"),r.a.createElement(g,{player:e.players[t],key:n+"name"}))})))))}),v=(n(39),n(40),function(e){var t=Object(a.useState)(0),n=Object(c.a)(t,2),l=(n[0],n[1],Object(a.useState)("")),o=Object(c.a)(l,2),s=o[0],u=o[1];return Object(a.useEffect)((function(){u((function(){return"roll-up"})),setTimeout((function(){return u("")}),1e3)}),[e.score]),r.a.createElement("div",{className:"score"},r.a.createElement("h1",{className:s},e.score))}),h=(n(43),function(){var e=Object(s.e)(),t=Object(a.useContext)(m).socket,n=Object(a.useContext)(u).setGameState,l=Object(a.useContext)(u).gameState;return r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"result-pop-up"},r.a.createElement("h1",null,"RESULTS:"),l.results.map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{key:e.id,score:e.points,player:e,textColor:e.color}))})),r.a.createElement("button",{onClick:function(){sessionStorage.clear(),e.push("/"),n(null),t.close()}},"Quit game")),"}")});var C=function(e){console.log(e);var t=Object(a.useContext)(u).gameState;return Object(a.useEffect)((function(){t&&sessionStorage.setItem("gameId",t.id)}),[t]),r.a.createElement(r.a.Fragment,null,t?r.a.createElement("div",{className:"game-screen"},r.a.createElement(S,{started:t.gameStarted}),t.results&&r.a.createElement(h,null),r.a.createElement("header",null,r.a.createElement("h1",null,r.a.createElement(y,null)),r.a.createElement("h3",null,"Game code: ",t.id),r.a.createElement("button",{onClick:function(){document.getElementsByClassName("game-screen")[0].requestFullscreen()}},"fullscreen")),r.a.createElement("main",null,t.activeQuestion&&r.a.createElement(j,null),Object.keys(t.players).map((function(e,n){var a=t.players[e];return r.a.createElement("section",{style:{backgroundColor:a.color},key:a.color},r.a.createElement("div",{className:"question-wrapper"},Object.keys(a.questions).map((function(e){return r.a.createElement(O,{question:a.questions[e],player:a,key:a.questions[e].question})}))),r.a.createElement(g,{player:a}),r.a.createElement(v,{score:a.points}))})))):r.a.createElement("p",null,"Loading game..."),r.a.createElement("pre",null,JSON.stringify(t,null,"  ")))},I=(n(44),n(45),function(){var e=Object(a.useContext)(u).gameState,t=Object(a.useState)(),n=Object(c.a)(t,2),r=n[0],l=n[1];return Object(a.useEffect)((function(){e&&l(e.players[sessionStorage.playerId])}),[e]),{player:r}}),k=function(e){var t=Object(a.useContext)(i).questions,n=Object(a.useContext)(u).gameState,l=Object(a.useState)(null),o=Object(c.a)(l,2),s=o[0],E=o[1],p=I().player,f=Object(a.useState)(null),d=Object(c.a)(f,2),y=d[0],g=d[1],b=Object(a.useState)(0),O=Object(c.a)(b,2),S=O[0],j=O[1],v=Object(a.useContext)(m).socket;Object(a.useEffect)((function(){v&&v.send(JSON.stringify({action:"GET_QUESTIONS"}))}),[v]),Object(a.useEffect)((function(){t&&(y||g(Array.from(new Set(t.map((function(e){return e.points}))))),E(t.filter((function(e){return e.points===(y||Array.from(new Set(t.map((function(e){return e.points})))))[0]}))))}),[t,y]);return r.a.createElement(r.a.Fragment,null,s?r.a.createElement("main",null,s.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"For ",s[S].points," points"),r.a.createElement("h1",null,s[S].question)):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,e.ready&&"You are ready \u2b50\ufe0f"),r.a.createElement("h2",null,"Waiting for \u23f3",r.a.createElement("br",null),Object.keys(n.players).map((function(e){var t=n.players[e];return!t.ready&&r.a.createElement("span",{key:t.id},t.emoji)}))))):r.a.createElement("p",null,"\u23f3"),r.a.createElement("footer",null,p&&!p.ready&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){return j((S+1)%s.length)}},r.a.createElement("span",{role:"img","aria-label":"reject"},"\u274c")),r.a.createElement("button",{onClick:function(){j(0),function(e){var t=y.filter((function(t){return t!==e.points}));g(t),v.send(JSON.stringify({action:"ADD_QUESTION",id:n.id,playerId:p.id,questionId:e.id})),0===t.length&&v.send(JSON.stringify({action:"SET_PLAYER_READY",id:n.id,playerId:p.id,ready:!0}))}(s[S])}},r.a.createElement("span",{role:"img","aria-label":"accept"},"\u2705")))))},N=(n(46),function(e){var t=e.player,n=Object(a.useContext)(u).gameState,l=Object(a.useContext)(m).socket,o=Object(a.useState)(0),s=Object(c.a)(o,2),i=s[0],E=s[1];console.log("QUESTIONS TO PICK: ",e.questions);Object(a.useEffect)((function(){!function(t){l.send(JSON.stringify({action:"SET_FOCUS",id:n.id,playerId:e.questions[t].playerId,questionId:e.questions[t].id,bool:!0}))}(i)}),[i]);var p=function(e){return e&&n.players[e.playerId]};return r.a.createElement(r.a.Fragment,null,n&&t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("main",null,r.a.createElement("h1",null,"Your turn to pick a question!"),r.a.createElement("div",{className:"question"},r.a.createElement("button",{onClick:function(){return E(i-1<0?(i-1)%e.questions.length+e.questions.length:(i-1)%e.questions.length)}},"<"),r.a.createElement("span",null,p(e.questions[i]).emoji),r.a.createElement(O,{question:e.questions[i],player:p(e.questions[i])}),r.a.createElement("button",{onClick:function(){return E((i+1)%e.questions.length)}},">"))),r.a.createElement("footer",null,r.a.createElement("button",{onClick:function(){l.send(JSON.stringify({action:"SET_ACTIVE_QUESTION",id:n.id,question:e.questions[i]}))}},r.a.createElement("span",{role:"img","aria-label":"reject"},"\u2705")))))}),q=(n(47),function(){var e=Object(a.useContext)(u).gameState,t=Object(a.useContext)(m).socket,n=Object(a.useState)(" "),l=Object(c.a)(n,2),o=l[0],s=l[1];return r.a.createElement(r.a.Fragment,null,o?r.a.createElement("main",null,r.a.createElement("h1",null,"Time to answer, good luck!"),r.a.createElement("form",{onSubmit:function(n){n.preventDefault(),t.send(JSON.stringify({action:"ANSWER",id:e.id,playerId:sessionStorage.playerId,answer:o})),s(null)},id:"answerForm"},r.a.createElement("textarea",{placeholder:"Type your answer here",onChange:function(e){return s(e.target.value)}}))):r.a.createElement("main",null,r.a.createElement("h1",null,"Waiting for ",e.players[e.activeQuestion.playerId].emoji," to correct the answers")),r.a.createElement("footer",null,o?r.a.createElement("button",{type:"submit",form:"answerForm",value:"Submit"},"Submit Answer"):r.a.createElement(r.a.Fragment,null)))}),x=(n(48),function(){var e=Object(a.useContext)(u).gameState,t=Object(a.useContext)(m).socket,n=Object(a.useState)(!1),l=Object(c.a)(n,2),o=l[0],s=l[1];Object(a.useEffect)((function(){Object.keys(e.activeQuestion.answers).length>0&&s(Object.keys(e.activeQuestion.answers).filter((function(t){return!e.activeQuestion.answers[t].hasOwnProperty("correct")})).map((function(t){return e.activeQuestion.answers[t]}))[0])}),[e]);var i=function(n,a){n.preventDefault(),t.send(JSON.stringify({action:"CORRECT_ANSWER",id:e.id,playerId:o.playerId,correct:a}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("main",null,r.a.createElement("h1",null,"This is your question! Answers will come in soon, stay ready!"),r.a.createElement("p",null,o&&o.answer)),r.a.createElement("footer",null,r.a.createElement("button",{onClick:function(e){return i(e,!1)}},r.a.createElement("span",{role:"img","aria-label":"reject"},"\u274c")),r.a.createElement("button",{onClick:function(e){return i(e,!0)}},r.a.createElement("span",{role:"img","aria-label":"accept"},"\u2705"))))}),w=(n(49),function(){var e=Object(a.useContext)(u).gameState,t=I().player,n=function(){return Object.keys(e.players).filter((function(n){return t&&e.players[n].id!==t.id})).map((function(t){return n=t,Object.keys(e.players[n].questions).map((function(t){return e.players[n].questions[t]}));var n})).flat().filter((function(e){return!e.answered}))};return r.a.createElement(r.a.Fragment,null,e&&t&&!e.activeQuestion?r.a.createElement(r.a.Fragment,null,e.turn===t.id&&n().length>0?r.a.createElement(N,{questions:n(),player:t}):r.a.createElement(r.a.Fragment,null,e.results?r.a.createElement("p",null,"Game has ended your score was: ",t.points,", and you got the ",e.results.findIndex((function(e){return e.id===t.id}))+1," place!"):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"\u23f3",r.a.createElement("br",null),"Waiting for ",r.a.createElement("span",null,e.players[e.turn].emoji," to pick a question")),r.a.createElement("footer",null)))):r.a.createElement(r.a.Fragment,null,e.activeQuestion&&e.activeQuestion.playerId===t.id?r.a.createElement(x,null):r.a.createElement(r.a.Fragment,null,e.activeQuestion&&r.a.createElement(q,null))))});var T=function(e){var t=Object(a.useContext)(u).gameState,n=Object(a.useContext)(m),l=n.socket,c=(n.setSocket,I().player);return Object(a.useEffect)((function(){1===l.readyState&&l.send(JSON.stringify({action:"GET_GAME_STATE",id:e.match.params.id,playerId:e.match.params.playerId}))}),[l,l.readyState,e.match.params.id,e.match.params.playerId]),r.a.createElement(r.a.Fragment,null,c&&sessionStorage.getItem("playerId")?r.a.createElement("div",{className:"game-controller"},r.a.createElement("header",{style:{backgroundColor:c.color||"#fff"}},r.a.createElement("h2",null,r.a.createElement("span",null,t.name),r.a.createElement(y,null),r.a.createElement("span",null,"Game Id: ",t.id)),r.a.createElement("span",null,c.emoji,r.a.createElement("input",{type:"text",onChange:function(e){return n=e.target.value,void l.send(JSON.stringify({action:"SET_USERNAME",id:t.id,playerId:c.id,username:n}));var n},placeholder:c.username||"Username",maxLength:"20",defaultValue:c.username||"Username",autoFocus:!0}))),t.gameStarted?r.a.createElement(w,null):r.a.createElement(k,null)):r.a.createElement("p",null,"Loading or you are not a player in this game..."),r.a.createElement("pre",{style:{overflow:"auto"}},JSON.stringify(t,null,"  ")))};var F=function(){var e=Object(a.useContext)(m).socket,t=Object(a.useState)(),n=Object(c.a)(t,2),l=n[0],E=n[1],p=Object(a.useState)(),f=Object(c.a)(p,2),y=f[0],g=f[1];return Object(a.useEffect)((function(){e&&(e.onmessage=function(e){var t=e.data;switch(JSON.parse(t).type){case"GAME_STATE":return E(JSON.parse(t).payload);case"PLAYER_ID":return sessionStorage.setItem("playerId",JSON.parse(t).payload);case"GAME_IN_PROGRESS":return E(JSON.parse(t).payload);case"QUESTIONS":return g(JSON.parse(t).payload);default:return}})}),[e,E,g]),Object(a.useEffect)((function(){console.log("GAME STATE UPDATED: ",l)}),[l]),r.a.createElement(o.a,null,r.a.createElement(u.Provider,{value:{gameState:l,setGameState:E}},r.a.createElement(s.a,{exact:!0,path:"/",component:d}),r.a.createElement(i.Provider,{value:{questions:y,setQuestions:g}},r.a.createElement(s.a,{exact:!0,path:"/game/:id",component:C}),r.a.createElement(s.a,{exact:!0,path:"/game/:id/:playerId",component:T}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A;A=F,Object(l.render)(r.a.createElement(E,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[22,1,2]]]);
//# sourceMappingURL=main.813a30e6.chunk.js.map